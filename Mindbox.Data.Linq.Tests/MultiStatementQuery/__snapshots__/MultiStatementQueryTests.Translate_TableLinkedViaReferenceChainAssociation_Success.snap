DECLARE @tabledirectcrm_Customers TABLE(
    AreaId int not null,
    Id int not null
)
DECLARE @tabledirectcrm_Areas TABLE(
    Id int not null,
    SubAreaId int null
)
DECLARE @tabledirectcrm_SubAreas TABLE(
    Id int not null,
    Name nvarchar(64) not null
)

INSERT INTO @tabledirectcrm_Customers
    SELECT current.AreaId, current.Id 
        FROM directcrm.Customers AS current
        WHERE Id = @pKeyId
SELECT * FROM @tabledirectcrm_Customers

INSERT INTO @tabledirectcrm_Areas
    SELECT current.Id, current.SubAreaId 
        FROM directcrm.Areas AS current
            INNER JOIN (SELECT DISTINCT AreaId FROM @tabledirectcrm_Customers) AS previous ON
                previous.AreaId = current.Id
SELECT * FROM @tabledirectcrm_Areas

INSERT INTO @tabledirectcrm_SubAreas
    SELECT current.Id, current.Name 
        FROM directcrm.SubAreas AS current
            INNER JOIN (SELECT DISTINCT SubAreaId FROM @tabledirectcrm_Areas) AS previous ON
                previous.SubAreaId = current.Id
SELECT * FROM @tabledirectcrm_SubAreas
